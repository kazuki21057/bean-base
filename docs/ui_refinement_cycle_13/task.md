# チャート改善とAI連携 (Cycle 13)

## 1. Radar Chart (レーダーチャート) の改善
- [x] **'Score' 軸の追加**:
  - [x] 全体的な品質を比較するため、7つ目の軸として `Overall Score` (0-10) を追加する。
  - [x] `StatisticsService.calculateRadarData` を更新し、平均スコアを計算・返却するようにする。
- [x] **Radar Chart の更なる改善 (User Feedback)**:
  - [x] **Scoreを頂点に**: データ順序を変更し、Scoreがトップ（12時方向）に来るようにする。
  - [x] **数値描画**: グリッド値として 2, 4, 6, 8, 10 を明示的に表示する（`ticksTextStyle` の調整や `tickCount` の確認）。
- [x] **全軸への数値表示**:
  - [x] `fl_chart` が全軸への目盛り表示をサポートしているか調査する。
  - [x] サポートされていない場合の回避策を実装:
    - [x] `ScatterChart` オーバーレイ等での手動描画（複雑すぎる場合は避ける）。
    - [x] **最善策**: 軸タイトルに数値を含める（例：「Fragrance (10)」）などの工夫で、数値の意味を明確にする。
    - [x] ※ユーザー要望通り「デバッグを強化し、確実に表示されるようにする」ための最善のアプローチを模索する。

## 2. PCA (主成分分析) の機能強化
- [x] **凡例 (Legend) レイアウト修正**:
  - [x] サイズインジケータを分離: 「Low」の近くに小さい丸、「High」の近くに大きい丸を配置し、視覚的な混乱を防ぐ。
- [x] **Gemini連携 (成分分析)**:
  - [x] **目的**: PC1/PC2 の重み（例: PC1 = 酸味0.6 + 苦味0.5）を分析し、自然言語での解釈（例: 「フルーティー vs ダーク」）を生成する。
  - [x] **実装戦略**:
    - [x] `google_generative_ai` パッケージを使用する。
    - [x] `GeminiService` を作成し、成分データを送信・解釈を受信するロジックを実装する。
    - [x] **APIキー**: ユーザー入力が必要。設定画面または入力ダイアログを実装する。
    - [x] **フォールバック**: 連携が難しい場合（APIキー未設定など）は、その理由をUIに表示し、静的な分析結果を表示する。
- [x] **Gemini API Error 修正**:
  - [x] モデル名を `gemini-1.5-flash` から `gemini-pro` (または `gemini-1.5-pro`) に変更し、"Not Found" エラーを解消する。

## 3. 検証
- [x] レーダーチャートにScoreを含む7軸が表示されていること。
- [x] 各軸に目盛り (2,4,6,8,10) が表示されているか、それに準ずる明確な表示があること。
- [x] PCAの凡例で、小さい丸が左側、大きい丸が右側に配置されていること。
- [x] Gemini分析ボタンがあり、APIキー設定後にインサイトが返されること。
