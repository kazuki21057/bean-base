# 修正と改善 (Walkthrough) - Cycle 2

## 実施した変更

### 1. CalculatorScreen の最適化
- 抽出ステップの表を以下のカラム構成に変更しました：
    - `#`: ステップ番号
    - `Time (s)`: 経過時間
    - `Total Weight (g)`: **累積注湯量** (注湯量の合計を表示)
    - `Description`: 説明
    - `Action`: 編集/削除
- 「Total Weight」を編集すると、自動的にそのステップの注湯量（Amount）が逆算・更新されるロジックを実装しました。

### 2. データ読み込みの完全対応
- **ログ読み込み不具合の修正**: `CoffeeRecord` モデルに堅牢なデータ変換ロジック (`_parseDateTime`, `_parseDouble`) を追加しました。これにより、Google Sheets上の日付フォーマット揺れ（"2023/1/1" vs "2023-01-01"）や、数値項目の文字列化（"20.5"）があってもクラッシュせず、正しく読み込まれるようになりました。
- **"Unknown" の排除**: 全てのマスターデータモデルで、デフォルト値 "Unknown ..." を廃止し、"-" や空文字に変更しました。これにより表示がすっきりしました。

### 3. 詳細画面の実装
- **MethodDetailScreen**: メソッド一覧でアイテムをクリックすると、詳細情報に加え、**Pouring Steps (抽出レシピ)** の表が表示されるようになりました。
- **LogDetailScreen**: 抽出ログ一覧でアイテムをクリックすると、パラメータ詳細や評価コメントを含む詳細画面が表示されるようになりました。

## 確認方法

### 自動テスト
全テストが通過することを確認済みです。
```bash
flutter test
```
特に `test/verification_test.dart` にて、不正なデータ形式（日付、数値）が正しく処理されることを追加検証しました。

### 手動確認手順 (`flutter run`)
1. **データ表示**: アプリ起動後、Log一覧やMasters一覧で "Unknown" が消え、以前表示されていなかったログが表示されていることを確認してください。
2. **Calculator**: メソッドを選択し、表が `Total Weight` を表示していること、および編集・保存（ダイアログ表示）が機能することを確認してください。
3. **詳細遷移**: Method一覧からクリックしてレシピ表が表示されること、Log一覧からクリックして詳細が表示されることを確認してください。
