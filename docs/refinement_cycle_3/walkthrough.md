# 修正と改善 (Walkthrough) - Cycle 3

## 実施した変更

### 1. CalculatorScreen の「Time」累積表示
- 抽出ステップの表の `Time (s)` 列を、各ステップの区間時間ではなく、**累積経過時間（累積到達時間）** を表示するように変更しました。
    - 入力時は自動的に区間時間（Duration）が計算・保存されます。
    - これにより、レシピ全体でのタイミングが把握しやすくなりました。

### 2. データ読み込みの不具合完全修正
- **日付フォーマット対応**: スプレッドシートの実データ `2025/04/14 7:39` に含まれるスラッシュ区切りや、時刻の0埋め不足（7:39 -> 07:39:00）を自動補正してパースする強力なロジックを実装しました。これにより、ログが表示されない（日付エラーでスキップされていた）問題が解消されました。
- **キーマッピングの整合**: ユーザー提供のシート画像に基づき、JSONキーとのマッピングを修正しました。
    - `抽出方法` -> `methodId`
    - `湯温(°C)` -> `temperature`
    - `蒸らし湯量(ml)` -> `bloomingWater`
    - `湯量(ml)` -> `totalWater`
    など、日本語ヘッダーとの不一致を解消しました。

### 3. 詳細画面の表示整理
- **不要項目の非表示**: `MethodDetailScreen` および `LogDetailScreen` において、値が `0`, `0.0`, `-`, 空文字, `null` の項目は画面に表示しないように変更しました。これにより、情報が入力されていない項目による無駄なスペースがなくなりました。

## 検証結果と確認手順

### 自動テストによる検証
スラッシュ区切り日付や日本語キーを含む実データを模したテストケースを追加し、正常に読み込めることを確認しました。
```bash
flutter test
# All tests passed!
```

### 実機での確認手順 (`flutter run`)
以下のコマンドを実行し、表示を確認してください。
```bash
flutter run
```

**確認ポイント:**
1.  **ログ一覧 (All Coffee Logs)**: 日付（例: `2025-04-14`）が表示され、リストが空でないことを確認してください。
2.  **ログ詳細**: リスト項目をタップし、詳細画面にデータが表示されていること、および `0` や空の項目が表示されていないことを確認してください。
    - 特に `湯温` や `抽出方法` がシート通りに表示されているか確認してください。
3.  **Calculator**: メソッドを選択し、テーブルの `Time (s)` 列が `0, 30, 60...` のように累積時間で表示されていることを確認してください。また、値を変更して全体の整合性が保たれるか試してください。
